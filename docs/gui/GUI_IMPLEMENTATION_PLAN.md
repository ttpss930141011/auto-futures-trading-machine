# GUI Implementation Plan

## ğŸ“‹ æ¦‚è¿°

æ­¤æ–‡æª”æ¦‚è¿°äº†å°‡ç¾æœ‰ CLI ç•Œé¢è½‰æ›ç‚º GUI ç•Œé¢çš„å¯¦ä½œè¨ˆåŠƒã€‚GUI å°‡æä¾›æ›´å‹å¥½çš„ä½¿ç”¨è€…é«”é©—ï¼ŒåŒæ™‚ä¿æŒèˆ‡ç¾æœ‰æ¶æ§‹çš„å®Œå…¨ç›¸å®¹æ€§ã€‚

## ğŸ¯ åŠŸèƒ½éœ€æ±‚

### æ ¸å¿ƒåŠŸèƒ½
1. **è‡ªå‹•ç™»å…¥**ï¼šå•Ÿå‹•æ™‚è‡ªå‹•ä½¿ç”¨ä¸Šæ¬¡çš„ç™»å…¥è³‡è¨Š
2. **è‡ªå‹•è¼‰å…¥ Register Item**ï¼šè¨˜ä½ä¸¦è¼‰å…¥ä¸Šæ¬¡é¸æ“‡çš„äº¤æ˜“å•†å“
3. **é è¨­ Order Account**ï¼šè‡ªå‹•é¸æ“‡ç¬¬ä¸€å€‹å¯ç”¨å¸³æˆ¶
4. **äº¤æ˜“æ¢ä»¶è¨­å®š**ï¼šæä¾›å‹å¥½çš„ç•Œé¢è¨­å®šäº¤æ˜“åƒæ•¸
5. **ç‹€æ…‹é¡¯ç¤º**ï¼šå³ä¸Šè§’é¡¯ç¤ºé¸æ“‡çš„ register item index
6. **ç³»çµ±ç›£æ§**ï¼šå³æ™‚é¡¯ç¤ºå„çµ„ä»¶ç‹€æ…‹

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### GUI æ¡†æ¶é¸æ“‡
æ¨è–¦ä½¿ç”¨ **PyQt6** æˆ– **Tkinter**ï¼š
- **PyQt6**ï¼šåŠŸèƒ½è±å¯Œã€ç¾ä»£åŒ– UIã€æ”¯æ´è¤‡é›œä½ˆå±€
- **Tkinter**ï¼šPython å…§å»ºã€è¼•é‡ç´šã€æ˜“æ–¼éƒ¨ç½²

### æ¶æ§‹æ•´åˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GUI Application                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Main Window                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Login   â”‚ â”‚ Register â”‚ â”‚   System     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Panel   â”‚ â”‚  Items   â”‚ â”‚   Monitor    â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚   â”‚
â”‚  â”‚  â”‚        Trading Conditions Panel         â”‚â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         ApplicationBootstrapper              â”‚   â”‚
â”‚  â”‚              ServiceContainer                â”‚   â”‚
â”‚  â”‚              SystemManager                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ å¯¦ä½œç´°ç¯€

### 1. ä¸»è¦–çª—ä½ˆå±€
```python
class MainWindow:
    def __init__(self):
        # é ‚éƒ¨å·¥å…·åˆ—
        - ç™»å…¥ç‹€æ…‹æŒ‡ç¤ºå™¨
        - Register Item é¡¯ç¤º (å³ä¸Šè§’)
        - ç³»çµ±ç‹€æ…‹æŒ‡ç¤ºç‡ˆ
        
        # ä¸»è¦å…§å®¹å€åŸŸ
        - å·¦å´ï¼šæ§åˆ¶é¢æ¿
          - ç™»å…¥/ç™»å‡º
          - Register Items é¸æ“‡
          - Order Account é¸æ“‡
        - ä¸­é–“ï¼šäº¤æ˜“æ¢ä»¶è¨­å®š
          - å‹•ä½œ (è²·/è³£)
          - ç›®æ¨™åƒ¹æ ¼
          - è½‰æŠ˜é»
          - æ•¸é‡
          - åœåˆ©/åœæ
        - å³å´ï¼šç³»çµ±ç›£æ§
          - çµ„ä»¶ç‹€æ…‹ (Gateway, Strategy, Order Executor)
          - å¸‚å ´æ•¸æ“šå³æ™‚é¡¯ç¤º
          - äº¤æ˜“è¨˜éŒ„
```

### 2. è‡ªå‹•åŒ–åŠŸèƒ½å¯¦ä½œ

#### è‡ªå‹•ç™»å…¥
```python
# ä½¿ç”¨ SessionRepository å„²å­˜å’Œè¼‰å…¥ç™»å…¥è³‡è¨Š
def auto_login(self):
    last_session = self.session_repository.get_last_valid_session()
    if last_session and not last_session.is_expired():
        # ä½¿ç”¨ UserLoginUseCase è‡ªå‹•ç™»å…¥
        self.login_use_case.execute(last_session.credentials)
```

#### è¨˜ä½ Register Items
```python
# ä½¿ç”¨ UserPreferencesRepository å„²å­˜é¸æ“‡
def save_register_items(self, items):
    preferences = {
        'register_items': items,
        'last_selected': datetime.now().isoformat()
    }
    self.preferences_repository.save(preferences)
```

### 3. äº¤æ˜“æ¢ä»¶è¨­å®šç•Œé¢

#### è¡¨å–®å…ƒä»¶
- **å‹•ä½œé¸æ“‡**ï¼šRadioButton (è²·/è³£)
- **åƒ¹æ ¼è¼¸å…¥**ï¼šSpinBox æˆ– LineEdit
- **æ•¸é‡è¨­å®š**ï¼šSpinBox
- **é€²éšé¸é …**ï¼šå¯æŠ˜ç–Šé¢æ¿
  - åœåˆ©è¨­å®š
  - åœæè¨­å®š
  - è·Ÿéš¨æ¢ä»¶

#### é©—è­‰é‚è¼¯
```python
def validate_condition(self):
    # ä½¿ç”¨ç¾æœ‰çš„ validation é‚è¼¯
    # å³æ™‚é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
    # é˜²æ­¢ç„¡æ•ˆè¼¸å…¥
```

### 4. ç³»çµ±ç›£æ§é¢æ¿

#### çµ„ä»¶ç‹€æ…‹é¡¯ç¤º
```python
class ComponentStatusWidget:
    def __init__(self, component_name):
        self.status_label = QLabel()
        self.uptime_label = QLabel()
        self.health_indicator = HealthIndicator()
        
    def update_status(self, status: ComponentStatus):
        # æ›´æ–°é¡¯ç¤º
        # ä½¿ç”¨é¡è‰²æŒ‡ç¤ºç‹€æ…‹
        # GREEN: RUNNING
        # YELLOW: STARTING/STOPPING
        # RED: ERROR/STOPPED
```

#### å³æ™‚æ•¸æ“šé¡¯ç¤º
- ä½¿ç”¨ QTimer å®šæœŸæ›´æ–°
- è¨‚é–± ZeroMQ å¸‚å ´æ•¸æ“š
- é¡¯ç¤ºæœ€æ–°å ±åƒ¹å’Œæˆäº¤é‡

## ğŸ”„ è³‡æ–™æµç¨‹

### å•Ÿå‹•æµç¨‹
```
1. GUI å•Ÿå‹•
   â†“
2. ApplicationBootstrapper.bootstrap()
   â†“
3. è‡ªå‹•ç™»å…¥ (å¦‚æœæœ‰å„²å­˜çš„ session)
   â†“
4. è¼‰å…¥ä½¿ç”¨è€…åå¥½è¨­å®š
   â†“
5. è‡ªå‹•é¸æ“‡ Register Items
   â†“
6. é è¨­é¸æ“‡ç¬¬ä¸€å€‹ Order Account
   â†“
7. é¡¯ç¤ºä¸»ç•Œé¢ï¼Œç­‰å¾…ä½¿ç”¨è€…æ“ä½œ
```

### äº¤æ˜“å•Ÿå‹•æµç¨‹
```
1. ä½¿ç”¨è€…è¨­å®šäº¤æ˜“æ¢ä»¶
   â†“
2. é»æ“Šã€Œå•Ÿå‹•äº¤æ˜“ã€æŒ‰éˆ•
   â†“
3. ApplicationStartupStatusUseCase æª¢æŸ¥å‰ç½®æ¢ä»¶
   â†“
4. SystemManager.start() å•Ÿå‹•æ‰€æœ‰çµ„ä»¶
   â†“
5. GUI å³æ™‚æ›´æ–°çµ„ä»¶ç‹€æ…‹
   â†“
6. é–‹å§‹é¡¯ç¤ºå¸‚å ´æ•¸æ“šå’Œäº¤æ˜“ä¿¡è™Ÿ
```

## ğŸ’¾ è³‡æ–™å„²å­˜

### ä½¿ç”¨è€…åå¥½è¨­å®š
```json
{
  "last_login": {
    "username": "encrypted_username",
    "environment": "test",
    "timestamp": "2025-01-01T10:00:00"
  },
  "register_items": ["TXF", "MXF"],
  "default_order_account": 0,
  "ui_preferences": {
    "theme": "dark",
    "window_size": [1200, 800],
    "panel_visibility": {
      "market_data": true,
      "trading_log": true
    }
  }
}
```

## ğŸš€ å¯¦ä½œæ­¥é©Ÿ

### Phase 1: åŸºç¤ GUI æ¡†æ¶
1. å»ºç«‹ GUI å°ˆæ¡ˆçµæ§‹
2. å¯¦ä½œä¸»è¦–çª—å’ŒåŸºæœ¬ä½ˆå±€
3. æ•´åˆ ApplicationBootstrapper

### Phase 2: æ ¸å¿ƒåŠŸèƒ½æ•´åˆ
1. å¯¦ä½œç™»å…¥ç•Œé¢å’Œè‡ªå‹•ç™»å…¥
2. æ•´åˆ Register Items é¸æ“‡
3. å¯¦ä½œ Order Account é¸æ“‡
4. å»ºç«‹äº¤æ˜“æ¢ä»¶è¨­å®šè¡¨å–®

### Phase 3: ç³»çµ±ç›£æ§å’Œæ§åˆ¶
1. å¯¦ä½œçµ„ä»¶ç‹€æ…‹é¡¯ç¤º
2. æ•´åˆ SystemManager æ§åˆ¶
3. æ·»åŠ å³æ™‚å¸‚å ´æ•¸æ“šé¡¯ç¤º

### Phase 4: é€²éšåŠŸèƒ½
1. å¯¦ä½œä½¿ç”¨è€…åå¥½è¨­å®šå„²å­˜
2. æ·»åŠ ä¸»é¡Œåˆ‡æ›
3. å¯¦ä½œäº¤æ˜“è¨˜éŒ„æŸ¥çœ‹
4. æ·»åŠ åœ–è¡¨é¡¯ç¤ºåŠŸèƒ½

## ğŸ“ å»ºè­°çš„æª”æ¡ˆçµæ§‹

```
src/
â”œâ”€â”€ gui/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main_window.py          # ä¸»è¦–çª—
â”‚   â”œâ”€â”€ widgets/                # è‡ªå®šç¾©å…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ login_widget.py
â”‚   â”‚   â”œâ”€â”€ register_items_widget.py
â”‚   â”‚   â”œâ”€â”€ conditions_widget.py
â”‚   â”‚   â”œâ”€â”€ system_monitor_widget.py
â”‚   â”‚   â””â”€â”€ market_data_widget.py
â”‚   â”œâ”€â”€ controllers/            # GUI æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ gui_controller.py
â”‚   â”œâ”€â”€ utils/                  # GUI å·¥å…·
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ validators.py
â”‚   â”‚   â””â”€â”€ formatters.py
â”‚   â””â”€â”€ resources/              # åœ–ç‰‡ã€æ¨£å¼ç­‰è³‡æº
â”‚       â”œâ”€â”€ icons/
â”‚       â””â”€â”€ styles/
â””â”€â”€ app_gui.py                  # GUI æ‡‰ç”¨ç¨‹å¼å…¥å£
```

## ğŸ”§ æŠ€è¡“è€ƒé‡

### åŸ·è¡Œç·’ç®¡ç†
- GUI åœ¨ä¸»åŸ·è¡Œç·’é‹è¡Œ
- ä½¿ç”¨ QThread æˆ– threading è™•ç†é•·æ™‚é–“æ“ä½œ
- é¿å…é˜»å¡ GUI éŸ¿æ‡‰

### éŒ¯èª¤è™•ç†
- ä½¿ç”¨å°è©±æ¡†é¡¯ç¤ºéŒ¯èª¤
- è¨˜éŒ„è©³ç´°éŒ¯èª¤æ—¥èªŒ
- æä¾›éŒ¯èª¤æ¢å¾©é¸é …

### æ•ˆèƒ½å„ªåŒ–
- é™åˆ¶å¸‚å ´æ•¸æ“šæ›´æ–°é »ç‡
- ä½¿ç”¨è™›æ“¬åŒ–æŠ€è¡“é¡¯ç¤ºå¤§é‡æ•¸æ“š
- å¯¦ä½œå»¶é²è¼‰å…¥

## ğŸ“ ç¸½çµ

æ­¤ GUI å¯¦ä½œå°‡å¤§å¹…æå‡ä½¿ç”¨è€…é«”é©—ï¼ŒåŒæ™‚ä¿æŒèˆ‡ç¾æœ‰æ¶æ§‹çš„å®Œå…¨ç›¸å®¹æ€§ã€‚é€šéé‡ç”¨ç¾æœ‰çš„ use cases å’Œ service containerï¼Œæˆ‘å€‘å¯ä»¥ç¢ºä¿æ¥­å‹™é‚è¼¯çš„ä¸€è‡´æ€§ï¼ŒåŒæ™‚æä¾›æ›´ç›´è§€çš„æ“ä½œç•Œé¢ã€‚